CREATE OR ALTER PROCEDURE [dbo].[sp_BusinessHour]
    @Action NVARCHAR(20),
    @Id BIGINT = NULL,
    @BusinessId BIGINT = NULL,
    @DayOfWeek TINYINT = NULL,
    @OpenTime TIME = NULL,
    @CloseTime TIME = NULL,
    @IsClosed BIT = NULL
AS
BEGIN
    SET NOCOUNT ON;

    IF @Action = 'GET'
    BEGIN
        SELECT * FROM BusinessHour WHERE Id = @Id;
    END

    IF @Action = 'GET_BY_BUSINESS'
    BEGIN
        SELECT * FROM BusinessHour WHERE BusinessId = @BusinessId ORDER BY DayOfWeek;
    END

    IF @Action = 'POST'
    BEGIN
        INSERT INTO BusinessHour (BusinessId, DayOfWeek, OpenTime, CloseTime, IsClosed)
        VALUES (@BusinessId, @DayOfWeek, @OpenTime, @CloseTime, ISNULL(@IsClosed,0));

        SET @Id = SCOPE_IDENTITY();
    END

    IF @Action = 'PUT'
    BEGIN
        UPDATE BusinessHour
        SET DayOfWeek = @DayOfWeek,
            OpenTime = @OpenTime,
            CloseTime = @CloseTime,
            IsClosed = @IsClosed
        WHERE Id = @Id;
    END

    IF @Action = 'DELETE'
    BEGIN
        DELETE FROM BusinessHour WHERE Id = @Id;
    END
END
